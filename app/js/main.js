$(document).ready(function(){var e=document.getElementsByClassName("slider__arrow--prev")[0],t=document.getElementsByClassName("slider__arrow--next")[0];$(".slides-container").slick({autoplay:!0,slidesToShow:1,arrows:!0,slidesToScroll:1,dots:!0,prevArrow:e,nextArrow:t,mobileFirst:!0,responsive:[{breakpoint:660,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:1030,settings:{slidesToShow:3,slidesToScroll:3}}]})}),function(){"use strict";var e,t;e={formFields:["name","email","message"],formId:"contact-form",getForm:function(){return document.getElementById("contact-form")},getFormData:function(){var e=this.getForm();return $(e).serialize()},send:function(){var e,s,n=this;return this.validateForm()>0?!1:(e=this.getFormData(),s="http://camp.efigence.com/camp/api/contact",$.ajax({method:"POST",crossDomain:!0,data:e,url:s}).done(function(e){t.clearForm(),t.showSendSuccess()}).fail(function(e){n.checkForResponseErrors(e),n.checkForResponseErrors(e)?n.parseResponseErrors(e):t.showSendError(e.status)}))},init:function(){this.addListeners()},addListeners:function(){for(var e=this.getForm(),t=this,s=0,n=this.formFields.length;n>s;s++)e[this.formFields[s]].addEventListener("blur",function(e){t.validateField({text:e.target.value,fieldName:e.target.name})});e.addEventListener("submit",function(e){e.preventDefault(),t.send()})},validateField:function(e){function s(e){return/[^@]+@[^@]+/.test(e)}function n(e){return isNaN(parseInt(e))?e.length>0:!1}var o;return o="email"===e.fieldName?s(e.text):n(e.text),o?(t.hideInvalidMessage(e),!0):(t.showInvalidMessage(e),!1)},validateForm:function(){for(var e,t=this.getForm(),s=0,n=0,o=this.formFields.length;o>n;n++)e=this.validateField({text:t[this.formFields[n]].value,fieldName:this.formFields[n]}),e||s++;return s},checkForResponseErrors:function(e){if(422===e.status){var t=JSON.parse(e.responseText);return t.hasOwnProperty("errors")}return!1},parseResponseErrors:function(e){var s=JSON.parse(e.responseText),n=[];for(var o in s.errors)n.push({fieldName:o,errorText:s.errors[o].join(" ")});for(var a=0,r=n.length;r>a;a++)t.showInvalidMessage(n[a])}},t={errorClass:"contact__input--error",showInvalidMessage:function(t){var s,n="[data-field="+t.fieldName+"]",o=e.getForm(),a=document.querySelector(n),r=a.childNodes[1];s="email"===t.fieldName?"Adres email jest nieprawidłowy":"Pole nie może być puste",s=t.errorText||s,a.classList.remove("hidden"),o[t.fieldName].classList.add(this.errorClass),r.textContent=s},hideInvalidMessage:function(t){var s="[data-field="+t.fieldName+"]",n=e.getForm(),o=document.querySelector(s);o&&(o.classList.add("hidden"),n[t.fieldName].classList.remove(this.errorClass))},showSendSuccess:function(){var e,t,s,n;e=document.getElementById("contact__send"),t=e.textContent,s="Wiadmość została wysłana",n="contact__send--success",e.classList.add(n),e.textContent=s,setTimeout(function(){e.classList.remove(n),e.textContent=t},3e3)},showSendError:function(e){var t,s,n,o,a,r,i;t=this,s=document.getElementById("contact__send"),n=s.textContent,o="Błąd!",a="contact__send--error",i=document.getElementById("error-text__code"),r=document.getElementsByClassName("contact__error-description")[0],s.classList.add(a),s.textContent=o,i.textContent=e,r.classList.remove("hidden"),setTimeout(function(){s.classList.remove(a),s.textContent=n,i.textContent="",r.classList.add("hidden"),t.clearForm()},5e3)},clearForm:function(){for(var t=e.getForm(),s=e.formFields,n=0,o=s.length;o>n;n++)t[s[n]].value=""}},e.init()}(),window.onload=function(){{var e={lat:52.230415,lng:20.997336},t=new google.maps.LatLng(e.lat,e.lng),s={zoom:16,streetViewControl:!1,scaleControl:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,center:t},n=document.getElementsByClassName("google-map")[0];new google.maps.Map(n,s)}},function(){"use strict";function e(e,t){return e.canPlayType(t).length>0||!1}function t(){r.addEventListener("error",function(){n()}),r.play(),r.pause()}function s(){var e="./video/video.mp4#t=1";r.src=e,r.load(),t()}function n(){var e=document.getElementById("video-alt-img"),t="./img/video-img.jpg";l.classList.add("hidden"),e.src=t,r.classList.add("hidden"),e.classList.remove("hidden")}function o(){var e=document.getElementsByClassName("controls__content")[0];e.classList.toggle("hidden"),d.classList.toggle("hidden")}function a(){c?(r.pause(),c=!1):(r.play(),c=!0)}var r=document.getElementById("header-video"),i="video/mp4",l=document.getElementsByClassName("controls__play")[0],d=document.getElementsByClassName("controls__pause--light")[0],c=!1;e(r,i)?s():n(),r.addEventListener("playing",function(){c=!0}),l.addEventListener("click",function(){o(),a()}),d.addEventListener("click",function(){o(),a()})}(),function(){var e=document.querySelector(".hamburger-button"),t=document.querySelector(".main-menu"),s="main-menu--collapsed",n="animated--scaleIn";animationCollapse="animated--scaleOut",animationDelay=300,e.addEventListener("click",function(){t.classList.contains(s)?(t.classList.toggle(s),t.classList.toggle(n)):(t.classList.toggle(n),t.classList.toggle(animationCollapse),setTimeout(function(){t.classList.toggle(s),t.classList.toggle(animationCollapse)},animationDelay)),e.classList.toggle("fa-bars"),e.classList.toggle("fa-times")})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcm91c2VsLmpzIiwiY29udGFjdC5qcyIsImdvb2dsZS1tYXBzLWJhY2tncm91bnMuanMiLCJ2aWRlby5qcyIsInRvb2dsZS1tZW51LmpzIl0sIm5hbWVzIjpbIiQiLCJkb2N1bWVudCIsInJlYWR5IiwiYXJyb3dQcmV2IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImFycm93TmV4dCIsInNsaWNrIiwiYXV0b3BsYXkiLCJzbGlkZXNUb1Nob3ciLCJhcnJvd3MiLCJzbGlkZXNUb1Njcm9sbCIsImRvdHMiLCJwcmV2QXJyb3ciLCJuZXh0QXJyb3ciLCJtb2JpbGVGaXJzdCIsInJlc3BvbnNpdmUiLCJicmVha3BvaW50Iiwic2V0dGluZ3MiLCJjb250YWN0U3RhdGUiLCJjb250YWN0VmlldyIsImZvcm1GaWVsZHMiLCJmb3JtSWQiLCJnZXRGb3JtIiwiZ2V0RWxlbWVudEJ5SWQiLCJnZXRGb3JtRGF0YSIsImZvcm0iLCJ0aGlzIiwic2VyaWFsaXplIiwic2VuZCIsInR4dCIsInVybCIsInRoYXQiLCJ2YWxpZGF0ZUZvcm0iLCJhamF4IiwibWV0aG9kIiwiY3Jvc3NEb21haW4iLCJkYXRhIiwiZG9uZSIsImNsZWFyRm9ybSIsInNob3dTZW5kU3VjY2VzcyIsImZhaWwiLCJjaGVja0ZvclJlc3BvbnNlRXJyb3JzIiwicGFyc2VSZXNwb25zZUVycm9ycyIsInNob3dTZW5kRXJyb3IiLCJzdGF0dXMiLCJpbml0IiwiYWRkTGlzdGVuZXJzIiwiaSIsImwiLCJsZW5ndGgiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInZhbGlkYXRlRmllbGQiLCJ0ZXh0IiwidGFyZ2V0IiwidmFsdWUiLCJmaWVsZE5hbWUiLCJuYW1lIiwicHJldmVudERlZmF1bHQiLCJvcHRpb25zIiwiaXNFbWFpbCIsInRlc3QiLCJpc05vdEVtcHR5IiwiaXNOYU4iLCJwYXJzZUludCIsImlzVmFsaWQiLCJoaWRlSW52YWxpZE1lc3NhZ2UiLCJzaG93SW52YWxpZE1lc3NhZ2UiLCJpbnZhbGlkQ291bnRlciIsInJlc3BvbnNlIiwiSlNPTiIsInBhcnNlIiwicmVzcG9uc2VUZXh0IiwiaGFzT3duUHJvcGVydHkiLCJlcnJvcnNBcnJheSIsImtleSIsImVycm9ycyIsInB1c2giLCJlcnJvclRleHQiLCJqb2luIiwiZXJyb3JDbGFzcyIsInF1ZXJ5IiwiY29udGFjdEZvcm0iLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZXJyb3JEZXNjcmlwdGlvbkVsZW1lbnQiLCJjaGlsZE5vZGVzIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwiYWRkIiwidGV4dENvbnRlbnQiLCJidXR0b24iLCJidXR0b25UZXh0Iiwic3VjY2Vzc1RleHQiLCJzdWNjZXNzQ2xhc3MiLCJzZXRUaW1lb3V0Iiwic3RhdHVzQ29kZSIsImJ1dHRvblRleHRFcnJvciIsImVycm9yTWVzc2FnZSIsImVycm9yQ29kZSIsImZpZWxkcyIsIndpbmRvdyIsIm9ubG9hZCIsImNvb3JkaW5hdGVzIiwibGF0IiwibG5nIiwibWFwIiwiZ29vZ2xlIiwibWFwcyIsIkxhdExuZyIsIm1hcE9wdGlvbnMiLCJ6b29tIiwic3RyZWV0Vmlld0NvbnRyb2wiLCJzY2FsZUNvbnRyb2wiLCJtYXBUeXBlSWQiLCJNYXBUeXBlSWQiLCJST0FETUFQIiwiY2VudGVyIiwibWFwQ29udGFpbmVyIiwiTWFwIiwiY2FuUGxheVRlc3QiLCJ2aWRlb0NsaXAiLCJmb3JtYXQiLCJjYW5QbGF5VHlwZSIsInRyeVRvUGxheSIsImhlYWRlclZpZGVvIiwibG9hZFZpZGVvQWx0SW1hZ2UiLCJwbGF5IiwicGF1c2UiLCJsb2FkSGVhZGVyVmlkZW8iLCJoZWFkZXJWaWRlb1VybCIsInNyYyIsImxvYWQiLCJ2aWRlb0FsdEltYWdlIiwidmlkZW9BbHRJbWFnZVNyYyIsInBsYXlCdXR0b24iLCJ0b2dnbGVDb250cm9scyIsImNvbnRyb2xzIiwidG9nZ2xlIiwicGF1c2VCdXR0b24iLCJ0b2dnbGVQbGF5IiwicGxheWluZ05vdyIsImJ0biIsIm1haW5NZW51IiwiY29sbGFwc2VDbGFzcyIsImFuaW1hdGlvbkV4cGFuZCIsImFuaW1hdGlvbkNvbGxhcHNlIiwiYW5pbWF0aW9uRGVsYXkiLCJjb250YWlucyJdLCJtYXBwaW5ncyI6IkFBQUFBLEVBQUFDLFVBQUFDLE1BQUEsV0FDQSxHQUFBQyxHQUFBRixTQUFBRyx1QkFBQSx1QkFBQSxHQUNBQyxFQUFBSixTQUFBRyx1QkFBQSx1QkFBQSxFQUVBSixHQUFBLHFCQUFBTSxPQUNBQyxVQUFBLEVBQ0FDLGFBQUEsRUFDQUMsUUFBQSxFQUNBQyxlQUFBLEVBQ0FDLE1BQUEsRUFDQUMsVUFBQVQsRUFDQVUsVUFBQVIsRUFDQVMsYUFBQSxFQUNBQyxhQUVBQyxXQUFBLElBQ0FDLFVBQ0FULGFBQUEsRUFDQUUsZUFBQSxLQUlBTSxXQUFBLEtBQ0FDLFVBQ0FULGFBQUEsRUFDQUUsZUFBQSxTQ3pCQSxXQUNBLFlBRUEsSUFBQVEsR0FBQUMsQ0FFQUQsSUFDQUUsWUFBQSxPQUFBLFFBQUEsV0FDQUMsT0FBQSxlQUNBQyxRQUFBLFdBQ0EsTUFBQXJCLFVBQUFzQixlQUFBLGlCQUVBQyxZQUFBLFdBQ0EsR0FBQUMsR0FBQUMsS0FBQUosU0FDQSxPQUFBdEIsR0FBQXlCLEdBQUFFLGFBRUFDLEtBQUEsV0FDQSxHQUFBQyxHQUFBQyxFQUFBQyxFQUFBTCxJQUVBLE9BQUFBLE1BQUFNLGVBQUEsR0FDQSxHQUdBSCxFQUFBSCxLQUFBRixjQUNBTSxFQUFBLDRDQUVBOUIsRUFBQWlDLE1BQ0FDLE9BQUEsT0FDQUMsYUFBQSxFQUNBQyxLQUFBUCxFQUNBQyxJQUFBQSxJQUVBTyxLQUFBLFNBQUFELEdBQ0FqQixFQUFBbUIsWUFDQW5CLEVBQUFvQixvQkFFQUMsS0FBQSxTQUFBSixHQUNBTCxFQUFBVSx1QkFBQUwsR0FDQUwsRUFBQVUsdUJBQUFMLEdBQ0FMLEVBQUFXLG9CQUFBTixHQUVBakIsRUFBQXdCLGNBQUFQLEVBQUFRLFlBSUFDLEtBQUEsV0FDQW5CLEtBQUFvQixnQkFFQUEsYUFBQSxXQUlBLElBQUEsR0FIQXJCLEdBQUFDLEtBQUFKLFVB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LEVBQUF4RCxVQUFBbUQsT0FBQVEsbUJBQ0FuRCxXQUFBLFdBQ0FnRCxFQUFBeEQsVUFBQW1ELE9BQUFNLEdBQ0FELEVBQUF4RCxVQUFBbUQsT0FBQVEsb0JBQ0FDLGlCQUVBTCxFQUFBdkQsVUFBQW1ELE9BQUEsV0FDQUksRUFBQXZELFVBQUFtRCxPQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGFycm93UHJldiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NsaWRlcl9fYXJyb3ctLXByZXYnKVswXTtcbiAgICB2YXIgYXJyb3dOZXh0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2xpZGVyX19hcnJvdy0tbmV4dCcpWzBdO1xuXG4gICAgJCgnLnNsaWRlcy1jb250YWluZXInKS5zbGljayh7XG4gICAgICAgIGF1dG9wbGF5OiB0cnVlLFxuICAgICAgICBzbGlkZXNUb1Nob3c6IDEsXG4gICAgICAgIGFycm93czogdHJ1ZSxcbiAgICAgICAgc2xpZGVzVG9TY3JvbGw6IDEsXG4gICAgICAgIGRvdHM6IHRydWUsXG4gICAgICAgIHByZXZBcnJvdzogYXJyb3dQcmV2LFxuICAgICAgICBuZXh0QXJyb3c6IGFycm93TmV4dCxcbiAgICAgICAgbW9iaWxlRmlyc3Q6IHRydWUsXG4gICAgICAgIHJlc3BvbnNpdmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBicmVha3BvaW50OiA2NjAsXG4gICAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAyLFxuICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Njcm9sbDogMlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgYnJlYWtwb2ludDogMTAzMCxcbiAgICAgICAgICAgICAgICBzZXR0aW5nczoge1xuICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDMsXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1RvU2Nyb2xsOiAzXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICBdXG4gICAgfSlcbn0pO1xuXG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHZhciBjb250YWN0U3RhdGUsIGNvbnRhY3RWaWV3O1xuXG4gICAgY29udGFjdFN0YXRlID0ge1xuICAgICAgICBmb3JtRmllbGRzOiBbJ25hbWUnLCAnZW1haWwnLCAnbWVzc2FnZSddLFxuICAgICAgICBmb3JtSWQ6ICdjb250YWN0LWZvcm0nLFxuICAgICAgICBnZXRGb3JtOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRhY3QtZm9ybScpO1xuICAgICAgICB9LFxuICAgICAgICBnZXRGb3JtRGF0YTogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZvcm0gPSB0aGlzLmdldEZvcm0oKTtcbiAgICAgICAgICAgIHJldHVybiAkKGZvcm0pLnNlcmlhbGl6ZSgpO1xuICAgICAgICB9LFxuICAgICAgICBzZW5kOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCA9IHRoaXMsIHR4dCwgdXJsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy52YWxpZGF0ZUZvcm0oKSA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHR4dCA9IHRoaXMuZ2V0Rm9ybURhdGEoKTtcbiAgICAgICAgICAgIHVybCA9ICdodHRwOi8vY2FtcC5lZmlnZW5jZS5jb20vY2FtcC9hcGkvY29udGFjdCc7XG5cbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGNyb3NzRG9tYWluOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRhdGE6IHR4dCxcbiAgICAgICAgICAgICAgICB1cmw6IHVybFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgY29udGFjdFZpZXcuY2xlYXJGb3JtKCk7XG4gICAgICAgICAgICAgICAgY29udGFjdFZpZXcuc2hvd1NlbmRTdWNjZXNzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgIHRoYXQuY2hlY2tGb3JSZXNwb25zZUVycm9ycyhkYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAodGhhdC5jaGVja0ZvclJlc3BvbnNlRXJyb3JzKGRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQucGFyc2VSZXNwb25zZUVycm9ycyhkYXRhKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250YWN0Vmlldy5zaG93U2VuZEVycm9yKGRhdGEuc3RhdHVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9LFxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmFkZExpc3RlbmVycygpO1xuICAgICAgICB9LFxuICAgICAgICBhZGRMaXN0ZW5lcnM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBmb3JtID0gdGhpcy5nZXRGb3JtKCksXG4gICAgICAgICAgICB0aGF0ID0gdGhpcztcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmZvcm1GaWVsZHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9ybVt0aGlzLmZvcm1GaWVsZHNbaV1dLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnZhbGlkYXRlRmllbGQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogZS50YXJnZXQudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE5hbWU6IGUudGFyZ2V0Lm5hbWVcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICB0aGF0LnNlbmQoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0sXG4gICAgICAgIHZhbGlkYXRlRmllbGQ6IGZ1bmN0aW9uIChvcHRpb25zKSB7IC8vIHt0ZXh0OiwgZmllbGROYW1lfVxuICAgICAgICAgICAgdmFyIGZvcm0sIGlzVmFsaWQ7XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmZpZWxkTmFtZSA9PT0gJ2VtYWlsJykge1xuICAgICAgICAgICAgICAgIGlzVmFsaWQgPSBpc0VtYWlsKG9wdGlvbnMudGV4dCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlzVmFsaWQgPSBpc05vdEVtcHR5KG9wdGlvbnMudGV4dCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICAgICAgICAgIGNvbnRhY3RWaWV3LnNob3dJbnZhbGlkTWVzc2FnZShvcHRpb25zKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRhY3RWaWV3LmhpZGVJbnZhbGlkTWVzc2FnZShvcHRpb25zKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaXNFbWFpbCh0ZXh0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC9bXkBdK0BbXkBdKy8udGVzdCh0ZXh0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gaXNOb3RFbXB0eSh0ZXh0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc05hTihwYXJzZUludCh0ZXh0KSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0Lmxlbmd0aCA+IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICB2YWxpZGF0ZUZvcm06IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBmb3JtID0gdGhpcy5nZXRGb3JtKCksXG4gICAgICAgICAgICBpbnZhbGlkQ291bnRlciA9IDAsXG4gICAgICAgICAgICBpc1ZhbGlkO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHRoaXMuZm9ybUZpZWxkcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpc1ZhbGlkID0gdGhpcy52YWxpZGF0ZUZpZWxkKHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogZm9ybVt0aGlzLmZvcm1GaWVsZHNbaV1dLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBmaWVsZE5hbWU6IHRoaXMuZm9ybUZpZWxkc1tpXVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgICAgICAgICAgICAgICAgIGludmFsaWRDb3VudGVyKys7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gaW52YWxpZENvdW50ZXI7XG4gICAgICAgIH0sXG4gICAgICAgIGNoZWNrRm9yUmVzcG9uc2VFcnJvcnM6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDQyMikge1xuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IEpTT04ucGFyc2UoZGF0YS5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5oYXNPd25Qcm9wZXJ0eSgnZXJyb3JzJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcGFyc2VSZXNwb25zZUVycm9yczogZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciByZXNwb25zZSA9IEpTT04ucGFyc2UoZGF0YS5yZXNwb25zZVRleHQpLFxuICAgICAgICAgICAgZXJyb3JzQXJyYXkgPSBbXTtcblxuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHJlc3BvbnNlLmVycm9ycykge1xuICAgICAgICAgICAgICAgIGVycm9yc0FycmF5LnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBmaWVsZE5hbWU6IGtleSxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JUZXh0OiByZXNwb25zZS5lcnJvcnNba2V5XS5qb2luKCcgJylcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZXJyb3JzQXJyYXkubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29udGFjdFZpZXcuc2hvd0ludmFsaWRNZXNzYWdlKGVycm9yc0FycmF5W2ldKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29udGFjdFZpZXcgPSB7XG4gICAgICAgIGVycm9yQ2xhc3M6ICdjb250YWN0X19pbnB1dC0tZXJyb3InLFxuICAgICAgICBzaG93SW52YWxpZE1lc3NhZ2U6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnkgPSAnW2RhdGEtZmllbGQ9JyArIG9wdGlvbnMuZmllbGROYW1lICsgJ10nLFxuICAgICAgICAgICAgY29udGFjdEZvcm0gPSBjb250YWN0U3RhdGUuZ2V0Rm9ybSgpLFxuICAgICAgICAgICAgZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihxdWVyeSksXG4gICAgICAgICAgICBlcnJvckRlc2NyaXB0aW9uRWxlbWVudCA9IGVycm9yRWxlbWVudC5jaGlsZE5vZGVzWzFdLFxuICAgICAgICAgICAgZXJyb3JUZXh0O1xuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5maWVsZE5hbWUgPT09ICdlbWFpbCcpIHtcbiAgICAgICAgICAgICAgICBlcnJvclRleHQgPSAnQWRyZXMgZW1haWwgamVzdCBuaWVwcmF3aWTFgm93eSc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGVycm9yVGV4dCA9ICdQb2xlIG5pZSBtb8W8ZSBiecSHIHB1c3RlJztcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBlcnJvclRleHQgPSBvcHRpb25zLmVycm9yVGV4dCB8fCBlcnJvclRleHQ7XG5cbiAgICAgICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgICAgICAgIGNvbnRhY3RGb3JtW29wdGlvbnMuZmllbGROYW1lXS5jbGFzc0xpc3QuYWRkKHRoaXMuZXJyb3JDbGFzcyk7XG4gICAgICAgICAgICBlcnJvckRlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yVGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgaGlkZUludmFsaWRNZXNzYWdlOiBmdW5jdGlvbiAob3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gJ1tkYXRhLWZpZWxkPScgKyBvcHRpb25zLmZpZWxkTmFtZSArICddJyxcbiAgICAgICAgICAgIGZvcm0gPSBjb250YWN0U3RhdGUuZ2V0Rm9ybSgpLFxuICAgICAgICAgICAgZXJyb3JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihxdWVyeSk7XG5cbiAgICAgICAgICAgIGlmIChlcnJvckVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgZm9ybVtvcHRpb25zLmZpZWxkTmFtZV0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmVycm9yQ2xhc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzaG93U2VuZFN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBidXR0b24sIGJ1dHRvblRleHQsIHN1Y2Nlc3NUZXh0LCBzdWNjZXNzQ2xhc3M7XG4gICAgICAgICAgICBidXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGFjdF9fc2VuZCcpO1xuICAgICAgICAgICAgYnV0dG9uVGV4dCA9IGJ1dHRvbi50ZXh0Q29udGVudDtcbiAgICAgICAgICAgIHN1Y2Nlc3NUZXh0ID0gJ1dpYWRtb8WbxIcgem9zdGHFgmEgd3lzxYJhbmEnO1xuICAgICAgICAgICAgc3VjY2Vzc0NsYXNzID0gJ2NvbnRhY3RfX3NlbmQtLXN1Y2Nlc3MnO1xuXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LmFkZChzdWNjZXNzQ2xhc3MpO1xuICAgICAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gc3VjY2Vzc1RleHQ7XG5cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHN1Y2Nlc3NDbGFzcyk7XG4gICAgICAgICAgICAgICAgYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcbiAgICAgICAgICAgIH0sIDMwMDApXG4gICAgICAgIH0sXG4gICAgICAgIHNob3dTZW5kRXJyb3I6IGZ1bmN0aW9uIChzdGF0dXNDb2RlKSB7XG4gICAgICAgICAgICB2YXIgdGhhdCwgYnV0dG9uLCBidXR0b25UZXh0LCBidXR0b25UZXh0RXJyb3IsIGVycm9yQ2xhc3MsIGVycm9yTWVzc2FnZSwgZXJyb3JDb2RlO1xuXG4gICAgICAgICAgICB0aGF0ID0gdGhpcztcbiAgICAgICAgICAgIGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb250YWN0X19zZW5kJyk7XG4gICAgICAgICAgICBidXR0b25UZXh0ID0gYnV0dG9uLnRleHRDb250ZW50O1xuICAgICAgICAgICAgYnV0dG9uVGV4dEVycm9yID0gJ0LFgsSFZCEnO1xuICAgICAgICAgICAgZXJyb3JDbGFzcyA9ICdjb250YWN0X19zZW5kLS1lcnJvcic7XG4gICAgICAgICAgICBlcnJvckNvZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZXJyb3ItdGV4dF9fY29kZScpO1xuICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29udGFjdF9fZXJyb3ItZGVzY3JpcHRpb24nKVswXTtcblxuICAgICAgICAgICAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoZXJyb3JDbGFzcyk7XG4gICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSBidXR0b25UZXh0RXJyb3I7XG4gICAgICAgICAgICBlcnJvckNvZGUudGV4dENvbnRlbnQgPSBzdGF0dXNDb2RlO1xuICAgICAgICAgICAgZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LnJlbW92ZShlcnJvckNsYXNzKTtcbiAgICAgICAgICAgICAgICBidXR0b24udGV4dENvbnRlbnQgPSBidXR0b25UZXh0O1xuICAgICAgICAgICAgICAgIGVycm9yQ29kZS50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB0aGF0LmNsZWFyRm9ybSgpO1xuICAgICAgICAgICAgfSwgNTAwMClcbiAgICAgICAgfSxcbiAgICAgICAgY2xlYXJGb3JtOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZm9ybSA9IGNvbnRhY3RTdGF0ZS5nZXRGb3JtKCksXG4gICAgICAgICAgICBmaWVsZHMgPSBjb250YWN0U3RhdGUuZm9ybUZpZWxkcztcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBmaWVsZHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9ybVtmaWVsZHNbaV1dLnZhbHVlID0gJyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29udGFjdFN0YXRlLmluaXQoKTtcbn0pKCk7XG4iLCJ3aW5kb3cub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjb29yZGluYXRlcyA9IHtsYXQ6IDUyLjIzMDQxNSwgbG5nOiAyMC45OTczMzZ9LFxuICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoY29vcmRpbmF0ZXMubGF0LCBjb29yZGluYXRlcy5sbmcpLFxuICAgIG1hcE9wdGlvbnMgPSB7XG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICBzdHJlZXRWaWV3Q29udHJvbDogZmFsc2UsXG4gICAgICAgIHNjYWxlQ29udHJvbDogdHJ1ZSxcbiAgICAgICAgbWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUCxcbiAgICAgICAgY2VudGVyOiBtYXBcbiAgICB9LFxuICAgIG1hcENvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2dvb2dsZS1tYXAnKVswXSxcbiAgICBiYWNrZ3JvdW5kTWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChtYXBDb250YWluZXIsIG1hcE9wdGlvbnMpO1xufTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIHZhciBoZWFkZXJWaWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZWFkZXItdmlkZW8nKSxcbiAgICBmb3JtYXQgPSAndmlkZW8vbXA0JyxcbiAgICBwbGF5QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29udHJvbHNfX3BsYXknKVswXSxcbiAgICBwYXVzZUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2NvbnRyb2xzX19wYXVzZS0tbGlnaHQnKVswXSxcbiAgICBwbGF5aW5nTm93ID0gZmFsc2U7XG5cbiAgICBpZiAoY2FuUGxheVRlc3QoaGVhZGVyVmlkZW8sIGZvcm1hdCkpIHtcbiAgICAgICAgbG9hZEhlYWRlclZpZGVvKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG9hZFZpZGVvQWx0SW1hZ2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYW5QbGF5VGVzdCh2aWRlb0NsaXAsIGZvcm1hdCkge1xuICAgICAgICByZXR1cm4gdmlkZW9DbGlwLmNhblBsYXlUeXBlKGZvcm1hdCkubGVuZ3RoID4gMCB8fCBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0cnlUb1BsYXkoKSB7XG4gICAgICAgIGhlYWRlclZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbG9hZFZpZGVvQWx0SW1hZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGhlYWRlclZpZGVvLnBsYXkoKTtcbiAgICAgICAgaGVhZGVyVmlkZW8ucGF1c2UoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsb2FkSGVhZGVyVmlkZW8oKSB7XG4gICAgICAgIHZhciBoZWFkZXJWaWRlb1VybCA9ICcuL3ZpZGVvL3ZpZGVvLm1wNCN0PTEnO1xuXG4gICAgICAgIGhlYWRlclZpZGVvLnNyYyA9IGhlYWRlclZpZGVvVXJsO1xuICAgICAgICBoZWFkZXJWaWRlby5sb2FkKCk7XG4gICAgICAgIHRyeVRvUGxheSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvYWRWaWRlb0FsdEltYWdlKCkge1xuICAgICAgICB2YXIgdmlkZW9BbHRJbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlby1hbHQtaW1nJyksXG4gICAgICAgIHZpZGVvQWx0SW1hZ2VTcmMgPSAnLi9pbWcvdmlkZW8taW1nLmpwZyc7XG5cbiAgICAgICAgcGxheUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAgICAgdmlkZW9BbHRJbWFnZS5zcmMgPSB2aWRlb0FsdEltYWdlU3JjO1xuICAgICAgICBoZWFkZXJWaWRlby5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICAgICAgdmlkZW9BbHRJbWFnZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB0b2dnbGVDb250cm9scygpIHtcbiAgICAgICAgdmFyIGNvbnRyb2xzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY29udHJvbHNfX2NvbnRlbnQnKVswXTtcbiAgICAgICAgY29udHJvbHMuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XG4gICAgICAgIHBhdXNlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHRvZ2dsZVBsYXkoKSB7XG4gICAgICAgIGlmIChwbGF5aW5nTm93KSB7XG4gICAgICAgICAgICBoZWFkZXJWaWRlby5wYXVzZSgpO1xuICAgICAgICAgICAgcGxheWluZ05vdyA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGVhZGVyVmlkZW8ucGxheSgpO1xuICAgICAgICAgICAgcGxheWluZ05vdyA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoZWFkZXJWaWRlby5hZGRFdmVudExpc3RlbmVyKCdwbGF5aW5nJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBwbGF5aW5nTm93ID0gdHJ1ZTtcbiAgICB9KTtcblxuXG4gICAgcGxheUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdG9nZ2xlQ29udHJvbHMoKTtcbiAgICAgICAgdG9nZ2xlUGxheSgpO1xuICAgIH0pO1xuXG4gICAgcGF1c2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRvZ2dsZUNvbnRyb2xzKCk7XG4gICAgICAgIHRvZ2dsZVBsYXkoKTtcbiAgICB9KTtcbn0pKCk7XG5cblxuXG4iLCIoZnVuY3Rpb24gKCkge1xuICAgIHZhciBidG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGFtYnVyZ2VyLWJ1dHRvbicpLFxuICAgIG1haW5NZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1haW4tbWVudScpLFxuICAgIGNvbGxhcHNlQ2xhc3MgPSAnbWFpbi1tZW51LS1jb2xsYXBzZWQnLFxuICAgIGFuaW1hdGlvbkV4cGFuZCA9ICdhbmltYXRlZC0tc2NhbGVJbic7XG4gICAgYW5pbWF0aW9uQ29sbGFwc2UgPSAnYW5pbWF0ZWQtLXNjYWxlT3V0JyxcbiAgICBhbmltYXRpb25EZWxheSA9IDMwMDtcblxuICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKG1haW5NZW51LmNsYXNzTGlzdC5jb250YWlucyhjb2xsYXBzZUNsYXNzKSkge1xuICAgICAgICAgICAgbWFpbk1lbnUuY2xhc3NMaXN0LnRvZ2dsZShjb2xsYXBzZUNsYXNzKTtcbiAgICAgICAgICAgIG1haW5NZW51LmNsYXNzTGlzdC50b2dnbGUoYW5pbWF0aW9uRXhwYW5kKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1haW5NZW51LmNsYXNzTGlzdC50b2dnbGUoYW5pbWF0aW9uRXhwYW5kKTtcbiAgICAgICAgICAgIG1haW5NZW51LmNsYXNzTGlzdC50b2dnbGUoYW5pbWF0aW9uQ29sbGFwc2UpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgbWFpbk1lbnUuY2xhc3NMaXN0LnRvZ2dsZShjb2xsYXBzZUNsYXNzKTtcbiAgICAgICAgICAgICAgICBtYWluTWVudS5jbGFzc0xpc3QudG9nZ2xlKGFuaW1hdGlvbkNvbGxhcHNlKTtcbiAgICAgICAgICAgIH0sIGFuaW1hdGlvbkRlbGF5KTtcbiAgICAgICAgfVxuICAgICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZSgnZmEtYmFycycpO1xuICAgICAgICBidG4uY2xhc3NMaXN0LnRvZ2dsZSgnZmEtdGltZXMnKTtcbiAgICB9KVxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==